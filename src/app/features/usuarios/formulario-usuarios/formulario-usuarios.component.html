<div class="mx-auto px-4 sm:px-8">
  <div class="py-2">
    <app-titulo-grilla
      [titulo]="titulo"
      [incluirNuevo]="false"
      [incluirVolver]="true"
      (volverClicked)="volver()"></app-titulo-grilla>
    <div
      [ngClass]="(loading$ | async) ? 'hidden' : 'block'"
      class="flex flex-col -mx-4 sm:-mx-8 px-4 sm:px-8">
      <div class="flex flex-row justify-center p-2">
        <form
          class="mat-elevation-z8 w-full rounded-lg overflow-hidden bg-white dark:bg-default-600 px-5 py-6"
          [formGroup]="formulario"
          (ngSubmit)="(null)"
          novalidate>
          <div class="grid xl:grid-cols-3 xl:gap-6">
            <div class="relative z-0 w-full mb-6 group">
              <input
                type="text"
                name="nombre"
                id="nombre"
                class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-teal-500 focus:outline-none focus:ring-0 focus:border-teal-600 peer"
                placeholder=" "
                formControlName="nombre" />
              <label
                for="nombre"
                class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:left-0 peer-focus:text-teal-600 peer-focus:dark:text-teal-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
                >Nombre<span class="text-red-600"> *</span></label
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('nombre')?.errors?.['required'] && formulario.get('nombre')?.touched ">
                Nombre es requerido</span
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('nombre')?.errors?.['minlength'] && formulario.get('nombre')?.touched ">
                Longitud mínima de 3 carácteres</span
              >
            </div>
            <div class="relative z-0 w-full mb-6 group">
              <input
                type="text"
                name="apellido"
                id="apellido"
                class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-teal-500 focus:outline-none focus:ring-0 focus:border-teal-600 peer"
                placeholder=" "
                formControlName="apellido" />
              <label
                for="apellido"
                class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:left-0 peer-focus:text-teal-600 peer-focus:dark:text-teal-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
                >Apellido<span class="text-red-600"> *</span></label
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('apellido')?.errors?.['required'] && formulario.get('apellido')?.touched  ">
                Apellido es requerido</span
              >
            </div>
            <div class="relative z-0 w-full mb-6 group">
              <mat-form-field
                class="w-full bg-transparent -mt-6 top-0.5"
                appearance="standard">
                <mat-label>Rol</mat-label>
                <mat-select
                  formControlName="rol"
                  required
                  class="text-primary-800 text-sm dark:text-default-200">
                  <mat-option
                    *ngFor="let r of [{ value: 'user' }, { value: 'admin' }]"
                    [value]="r.value"
                    class="text-primary-800 text-sm dark:text-default-200 dark:bg-default-800">
                    {{ r.value | visRoles }}
                  </mat-option>
                </mat-select>
                <mat-error
                  *ngIf="formulario.get('rol')?.errors?.['required'] && formulario.get('rol')?.touched  "
                  class="mt-2 text-sm text-red-600 dark:text-red-500"
                  >Rol es requerido</mat-error
                >
              </mat-form-field>
            </div>
          </div>

          <div class="grid xl:grid-cols-3 xl:gap-6">
            <div class="relative z-0 w-full mb-6 group">
              <input
                type="email"
                name="email"
                class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-teal-500 focus:outline-none focus:ring-0 focus:border-teal-600 peer"
                placeholder=" "
                formControlName="email" />
              <label
                for="email"
                class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:left-0 peer-focus:text-teal-600 peer-focus:dark:text-teal-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
                >Correo electrónico<span class="text-red-600"> *</span></label
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('email')?.errors?.['required'] && formulario.get('email')?.touched ">
                Correo electrónico es requerido</span
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('email')?.errors?.['pattern'] && formulario.get('email')?.touched ">
                Debe ingresar un correo válido</span
              >
            </div>
            <div class="relative z-0 w-full mb-6 group">
              <input
                type="password"
                name="password"
                id="password"
                class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-teal-500 focus:outline-none focus:ring-0 focus:border-teal-600 peer"
                placeholder=" "
                formControlName="password" />
              <label
                for="password"
                class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:left-0 peer-focus:text-teal-600 peer-focus:dark:text-teal-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
                >Clave<span class="text-red-600"> *</span></label
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('password')?.errors?.['required'] && formulario.get('password')?.touched ">
                Una clave es requerida</span
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('password')?.errors?.['minlength'] && formulario.get('password')?.touched ">
                Longitud minima de 8 carácteres</span
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.errors?.['mismatch']  && formulario.get('password')?.touched  && formulario.get('confirmPassword')?.touched ">
                Las claves no coinciden</span
              >
            </div>
            <div class="relative z-0 w-full mb-6 group">
              <input
                type="password"
                name="confirmPassword"
                id="confirmPassword"
                class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-teal-500 focus:outline-none focus:ring-0 focus:border-teal-600 peer"
                placeholder=" "
                formControlName="confirmPassword" />
              <label
                for="confirmPassword"
                class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:left-0 peer-focus:text-teal-600 peer-focus:dark:text-teal-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
                >Confirmar clave<span class="text-red-600"> *</span></label
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('confirmPassword')?.errors?.['required'] && formulario.get('confirmPassword')?.touched ">
                Reingresar la clave es requerido</span
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.get('confirmPassword')?.errors?.['minlength'] && formulario.get('confirmPassword')?.touched ">
                Longitud minima de 8 carácteres</span
              >
              <span
                class="mt-2 text-sm text-red-600 dark:text-red-500"
                *ngIf="formulario.errors?.['mismatch']  && formulario.get('password')?.touched  && formulario.get('confirmPassword')?.touched ">
                Las claves no coinciden</span
              >
            </div>
          </div>
          <div class="grid xl:grid-cols-2 xl:gap-6">
            <div class="relative z-0 w-full mb-0 group">
              <label
                for="descripcion"
                class="block mb-2 text-sm font-sm text-gray-500 dark:text-gray-400"
                >Descripción</label
              >
              <textarea
                id="descripcion"
                rows="4"
                class="block p-2.5 w-full text-sm outline-none text-gray-900 bg-white rounded-lg border border-gray-300 focus:ring-teal-900 focus:border-teal-900 dark:bg-default-700 dark:border-default-600 dark:placeholder-default-400 dark:text-white dark:focus:ring-default-500 dark:focus:border-default-500"
                placeholder=""
                formControlName="descripcion"></textarea>
            </div>
            <div class="relative z-0 w-full mb-0 group">
              <label
                class="block mb-2 text-sm font-sm text-gray-500 dark:text-gray-400">
                Avatar
              </label>
              <div class="mt-1 flex items-center">
                <app-avatar [imagen]="formulario.value.imagen"></app-avatar>
                <div class="relative z-0 w-full mb-0 group ml-3">
                  <input
                    type="text"
                    name="imagen"
                    id="imagen"
                    class="block py-2.5 px-0 w-full text-sm text-gray-900 bg-transparent border-0 border-b-2 border-gray-300 appearance-none dark:text-white dark:border-gray-600 dark:focus:border-teal-500 focus:outline-none focus:ring-0 focus:border-teal-600 peer"
                    placeholder=" "
                    formControlName="imagen" />
                  <label
                    for="imagen"
                    class="peer-focus:font-medium absolute text-sm text-gray-500 dark:text-gray-400 duration-300 transform -translate-y-6 scale-75 top-3 -z-10 origin-[0] peer-focus:left-0 peer-focus:text-teal-600 peer-focus:dark:text-teal-500 peer-placeholder-shown:scale-100 peer-placeholder-shown:translate-y-0 peer-focus:scale-75 peer-focus:-translate-y-6"
                    >Link/URL</label
                  >
                  <p
                    id="helper-text-explanation"
                    class="mt-2 text-sm text-gray-500 dark:text-gray-400">
                    Ingrese el link al avatar creado en alguna de las
                    herramientas online existentes, como por ejemplo
                    <a
                      href="https://getavataaars.com/"
                      target="_blank"
                      class="font-medium text-teal-600 hover:underline dark:text-teal-500"
                      >getavataaars.com</a
                    >.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <div
            class="flex flex-shrink-0 flex-wrap text-right justify-end p-4 mt-16">
            <div
              class="flex-1 break-words mt-2 text-sm text-red-600 dark:text-red-500 mr-5"
              *ngIf="formulario.invalid">
              Los campos marcados con * son requeridos
            </div>
            <div class="">
              <button
                (click)="cancelar()"
                class="inline-block px-6 py-2.5 mr-2 bg-primary-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-primary-700 hover:shadow-lg focus:bg-primary-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-secondary-500 active:shadow-lg transition duration-150 ease-in-out">
                Cancelar
              </button>
              <button
                mat-button
                (click)="agregarUsuario(formulario.value)"
                class="inline-block px-6 py-2.5 bg-primary-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-primary-700 hover:shadow-lg focus:bg-primary-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-secondary-500 active:shadow-lg transition duration-150 ease-in-out cursor-pointer disabled:cursor-not-allowed disabled:opacity-75"
                [disabled]="formulario.invalid">
                Guardar
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<div
  *ngIf="loading$ | async"
  class="w-full h-full fixed block top-0 left-0 bg-white opacity-75 z-50">
  <span
    class="text-prymary-500 opacity-75 top-1/2 my-0 mx-auto block relative w-0 h-0">
    <mat-spinner></mat-spinner>
  </span>
</div>
